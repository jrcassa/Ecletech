<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auditoria - Ecletech</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/auditoria.css">

    <!-- CSS Centralizado -->
    <link rel="stylesheet" href="css/sidebar.css">
</head>

<body>
    <div id="sidebar-container"></div>

    <div class="main-content" id="mainContent">
        <header class="header">
            <div class="header-left">
                <button class="menu-toggle" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1>Auditoria</h1>
            </div>
            <div class="header-right">
                <button class="theme-toggle" id="themeToggle" title="Alternar tema">
                    <i class="fas fa-moon"></i>
                </button>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="carregarEstatisticas()">üìä Estat√≠sticas</button>
                    <button class="btn" onclick="window.location.href='./logout.html'">Sair</button>
                </div>
            </div>
        </header>

        <div class="container">
            <!-- Estat√≠sticas -->
            <div class="card" id="statsCard" style="display: none;">
                <h2>Estat√≠sticas (√öltimos 30 dias)</h2>
                <div class="stats-grid" id="statsGrid"></div>
            </div>

            <!-- Filtros -->
            <div class="card">
                <h2>Filtros</h2>
                <div class="filters">
                    <div class="filter-group">
                        <label>A√ß√£o</label>
                        <select id="filtroAcao">
                            <option value="">Todas</option>
                            <option value="criar">Criar</option>
                            <option value="atualizar">Atualizar</option>
                            <option value="deletar">Deletar</option>
                            <option value="restaurar">Restaurar</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Tabela</label>
                        <select id="filtroTabela">
                            <option value="">Todas</option>
                            <option value="colaborador">Colaborador</option>
                            <option value="colaborador_nivel">Colaborador N√≠vel</option>
                            <option value="colaborador_role">Colaborador Role</option>
                            <option value="colaborador_permission">Colaborador Permission</option>
                            <option value="frota">Frota</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Usu√°rio ID</label>
                        <input type="number" id="filtroUsuarioId" placeholder="ID do usu√°rio">
                    </div>
                    <div class="filter-group">
                        <label>Data In√≠cio</label>
                        <input type="date" id="filtroDataInicio">
                    </div>
                    <div class="filter-group">
                        <label>Data Fim</label>
                        <input type="date" id="filtroDataFim">
                    </div>
                </div>
                <div class="filter-actions">
                    <button class="btn" onclick="aplicarFiltros()">Filtrar</button>
                    <button class="btn btn-secondary" onclick="limparFiltros()">Limpar</button>
                </div>
            </div>

            <!-- Tabela de Auditoria -->
            <div class="card">
                <h2>Registros de Auditoria</h2>
                <div id="loadingContainer" class="loading">
                    <div class="loading-spinner"></div>
                    <p>Carregando registros...</p>
                </div>
                <div id="errorContainer" class="error-message" style="display: none;">
                    <strong>Erro:</strong> <span id="errorMessage"></span>
                </div>
                <div id="tableContainer" class="table-container" style="display: none;">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Data/Hora</th>
                                <th>Usu√°rio</th>
                                <th>A√ß√£o</th>
                                <th>Tabela</th>
                                <th>Registro ID</th>
                                <th>IP</th>
                            </tr>
                        </thead>
                        <tbody id="auditoriaTableBody"></tbody>
                    </table>
                    <div class="pagination">
                        <button id="btnPrevPage" onclick="anteriorPagina()">‚Üê Anterior</button>
                        <span class="page-info" id="pageInfo">P√°gina 1</span>
                        <button id="btnNextPage" onclick="proximaPagina()">Pr√≥xima ‚Üí</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Detalhes -->
    <div class="modal" id="detalhesModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Detalhes da Auditoria</h3>
                <button class="close-modal" onclick="fecharModal()">√ó</button>
            </div>
            <div id="detalhesContent"></div>
        </div>
    </div>

    <script src="js/API.js"></script>
    <script src="js/Auth.js"></script>
    <script src="js/Utils.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/sidebar.js"></script>
    <script src="js/auditoria.js"></script>
    
</body>

</html>
